      SUBROUTINE SJACK(K1,KSU1,KSU2,MFL)
      IMPLICIT double precision (A-H,O-Z)
C     DIESE SUBROUTINE BERECHNET DIE JACOBI KOORDINATEN UND SCHREIBT
C     SIE AUF BAND
C     EINGABE !  K1 = ZAHL DER CLUSTER, MFL= NR DER ZERLEGUNG
C     KSU1 IST DIE ANZAHL DER SUBSTRUKTUREN IN FRAGMENT1
C     KSU2 IST DIE ANZAHL DER SUBSTRUKTUREN IN FRAGMENT2
C     SVEC ENTHAELT DIE JACOBIKOORDINATEN ALS FUNKTION DER EINTEILCHEKOORD
C     DIE ORTHOGONALE TRANSFORMATION WIRD OHNE!!! DEN SCHWERPUNKT AUSGEFUE
C     RVEC ENTHAELT DIE DAZU TRANSPONIERTE MATRIX
C     C(.,.,K) =1, KENNZEICHNET DIE INNEREN JACOBIKOOR. VON CLUSTER K
C      C(.,.,K) =1 FUER K=NZC CHARAKTERISIERT DIE RELATIV KOORDINATEN
C
C
      INCLUDE 'par/KOBER'
C
      PARAMETER (NZTMA1=NZTMAX-1)
C
      COMMON /CKO/ VEC(NZTMAX,NZTMA1,NZFMAX),
     *             C(NZTMA1,NZTMA1,2*NZCMAX-1),
     *             RVEC(NZTMAX,NZTMAX),SVEC(NZTMAX,NZTMAX)
C
      COMMON /SJA/ NGRU(2,NZCMAX+1,2),NZT,NZV, KSU, JSU(2,NZCMAX+1)
C
      K2=K1-1
      K4=K1 + K2
      DO 2124 K=1,NZV
      DO 2124 L=1,NZT
2124  SVEC(L,K)=0.
      DO 2125 K=1,NZV
      DO 2125 L=1,NZV
      DO 2125 I=1,K4
2125  C(K,L,I)=0.
      I = 0
C
C     BLOCK CLUSTER INTERNE KOORDINATEN
C
      DO 10   K = 1,K1
      IF(NGRU(2,K,1).EQ.1) GOTO 10
       DO 12   L = 1,NGRU(2,K,1) -1
      I = I + 1
      DO 13   M = 1,L
   13 SVEC(NGRU(1,K,1) + M - 1 ,I) = -1.D0/ DBLE(L)
   12 SVEC( NGRU(1,K,1) + L ,I) = 1.D0
   10 CONTINUE
C
C     BLOCK CLUSTER INTERNE KOORDINATEN ZUEND
C
C     BLOCK SUBSTRUKTUR INTERNE KOORDINATEN
C
      DO 110 K=1,KSU
      IF(JSU(2,K).EQ.1) GOTO 110
      DO 112 L= 2,JSU(2,K)
      I= I + 1
      L1=NGRU(1,JSU(1,K) + L-1,1)
      L5=NGRU(1,JSU(1,K) ,1)
      DO 113 M= L5,L1 -1
113   SVEC(M,I)= -1.D0/DBLE(L1 - L5)
      DO 123 M=	L1, L1 + NGRU(2,JSU(1,K) +L-1,1) -1
123   SVEC(M,I)= 1.D0/DBLE(NGRU(2,JSU(1,K) +L-1,1))
112   CONTINUE
110   CONTINUE
C
C     BLOCK SUBSTRUKTUR INTERNE KOORDINATEN ZUEND
C
C     BLOCK SUBSTRUKTUR RELATIV KOORDINATEN
C
      IF(KSU1.EQ.1) GOTO 14
       DO 16   K = 2,KSU1
      I = I + 1
      L1 = NGRU(1,JSU(1,K),1) -1
      DO 17   M = 1,L1
   17 SVEC(M,I) = -1.D0/ DBLE(L1)
      L3 = NGRU(1,JSU(1,K+ 1),1) -1
      DO 16   M = L1+1,L3
   16 SVEC(M,I) =  1.D0/ DBLE(L3- L1)
   14 IF(KSU2.EQ.1) GOTO 24
      DO 21   K = 2,KSU2
      I = I + 1
      L1 = NGRU(1,JSU(1,KSU1+ 1),1)
      L5 = NGRU(1,JSU(1,KSU1+ K),1) -1
      DO 22   M = L1,L5 + 1
   22 SVEC(M,I) =-1.D0/ DBLE(L5-L1+1)
      L3 = NGRU(1,JSU(1,KSU1+ K + 1),1) - 1
      DO 23   M = L5 + 1,L3
   23 SVEC(M,I) = 1.D0/ DBLE(L3 - L5)
   21 CONTINUE
C
C     BLOCK SUBSTRUKTUR RELATIV KOORDINATEN ZUEND
C
C     RELATIV- UND SCHWERPUNKT KOORDINATE
C
   24  L4 = NGRU(1,JSU(1,KSU1 + 1),1) - 1
      DO 26   M  = 1,L4
      SVEC(M,NZV) = -1.D0/ DBLE(L4)
   26 SVEC(M,NZT) = 1.D0/ DBLE(NZT)
      DO 27   M = L4 + 1,NZT
      SVEC(M,NZV) = 1.D0/ DBLE(NZT-L4)
   27 SVEC(M,NZT) = 1.D0/ DBLE(NZT)
C
C     RELATIV- UND SCHWERPUNKT KOORDINATE ZUEND
C
C     NORMIERUNG
C
      DO 60   K = 1,NZT
      A = .0
      DO 61   L = 1,NZT
   61 A = A + SVEC(L,K)**2
      A = 1.D0/ SQRT(A)
      DO 62  L = 1,NZT
   62 SVEC(L,K) = A*SVEC(L,K)
   60 CONTINUE
      DO 30   K = 1,NZT
      DO 30   L = 1,NZT
      RVEC(L,K) = SVEC(K,L)
   30 CONTINUE
      WRITE(NOUT,40)
       DO 34   K = 1,NZV
      L1 = NZV - K2 + K
      WRITE(NOUT,41)    K,(SVEC(M,K ),M,M=1,NZT)
      IF(K.GE.K1) GOTO 34
        DO 70    M = 1,NZT
   70 VEC(M,K,MFL) = SVEC(M,L1)
C      VEC ENTHAELT DIE CLUSTERRELATIVKOORDINATEN
   34 CONTINUE
   40 FORMAT(//28H DEFINITION DER KOORDINATEN      //)
   41 FORMAT(3H S(,I2,3H) =,10(F6.3,3H R(,I2,1H)  ) / 7X,
     1         2(F6.3,3H R(,I2,1H)))
   42 FORMAT(3H R(,I2,3H) =,10(F6.3,3H S(,I2,1H)  ) / 7X,
     1         2(F6.3,3H S(,I2,1H)))
   43 FORMAT(//)
      WRITE(NOUT,43)
      DO 36   K = 1,NZT
   36 WRITE(NOUT,42)   K,(RVEC(M,K),M,M=1,NZV)
      WRITE(NOUT,43)
      DO 37 K= 1,K2
37    WRITE (NOUT,45) K,(VEC(M,K,MFL),M,M=1,NZT)
45    FORMAT(' VEC(',I2,')=',10(F6.3,' R(',I2,')'))
      WRITE(NOUT,43)
      IIZ = 0
      DO 2130 K=1,K1
      NNZ   = NGRU(2,K,1)  - 1
      IF(NNZ.EQ.0) GOTO 2130
       DO 2132    M = 1,NNZ
      IIZ = IIZ + 1
 2132 C(IIZ,IIZ,K) = 1.
      WRITE(NOUT,44) (C(M,M,K),M=1,NZV)
   44 FORMAT(10F10.4)
 2130 CONTINUE
      WRITE(NOUT,43)
      DO 50   K = 1,K2
      KK=NZV-K2+K
      KI = K1 + K
   50 C(KK,KK ,KI) = 1.
      DO 51 K=1,K4
51      WRITE (NOUT,44) (C(M,M,K),M=1,NZV)
      RETURN
      END
